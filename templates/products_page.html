<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Products - EcommerceShop</title>
</head>
<body>

    <!-- Navbar -->
    <nav>
        <h2>EcommerceShop</h2>
        <a href="{% url 'home_page' %}">Home</a>
        <a href="#">Categories</a>
        <a href="{% url 'products_page' %}">Products</a>
        {% if user.is_authenticated %}
            <a href="{% url 'logout' %}">Logout</a>
        {% else %}
            <a href="{% url 'login' %}">Login</a>
            <a href="{% url 'register' %}">Register</a>
        {% endif %}
        <form method="GET" action="{% url 'product_search' %}" style="display:inline;">
            <input type="text" name="q" placeholder="Search products...">
            <button type="submit">Search</button>
        </form>
        {% if user.is_authenticated %}
        <div style="margin-top: 30px;">
            <a href="{% url 'add_product' %}"><button>Add a New Product</button></a>
        </div>
    {% endif %}
    </nav>

    <h1>Products</h1>

    <div style="display: flex;">
        <!-- Left Sidebar: Categories -->
        <div style="width: 20%; border-right: 1px solid black;">
            <h3>Filters</h3>
            <p><strong>Categories</strong></p>
            <ul>
                <li><a href="{% url 'products_page' %}">All Products</a></li>
                {% for cat in categories %}
                    <li>
                        <a href="?category={{ cat.id }}"
                           {% if selected_category == cat.id %}style="font-weight: bold;"{% endif %}>
                           {{ cat.name }}
                        </a>
                    </li>
                {% endfor %}
            </ul>
        </div>

        <!-- Products Grid -->
        <div style="width: 20%; padding-left: 20px;">
            {% if products %}
                {% for prod in products %}
                    <div style="border: 1px solid black; padding: 10px; margin: 10px;">
                        <h2>{{ prod.name }}</h2>
                        <p><strong>Category:</strong> {{ prod.Categories.name }}</p>
                        <p><strong>Description:</strong> {{ prod.description }}</p>
                        <p><strong>Price:</strong> â‚¹{{ prod.price }}</p>
                        <p><strong>Status:</strong> In Stock</p>
                        {% if prod.Product_image %}
                            <img src="{{ prod.Product_image.url }}" alt="Image" width="150">
                        {% else %}
                            <p>No Image</p>
                        {% endif %}
                        <br>
                        <form method="POST" action="{% url 'add_to_cart_from_products' prod.id %}" style="display:inline;">
                            {% csrf_token %}
                            <button type="submit">Add to Cart</button>
                        </form>
                        <form method="POST" action="{% url 'cart_page' %}" style="display:inline;">
                            {% csrf_token %}
                            <button type="submit">View Cart</button>
                        </form>
                        <form action="{% url 'delete_product' prod.id %}" method="POST" style="margin-top:10px;">
                            {% csrf_token %}
                            <button type="submit" onclick="return confirm('Are you sure you want to delete this product?');">
                                Delete
                            </button>
                        </form>
                    </div>
                {% empty %}
                 <!-- <p>No products available.</p>-->
                       {% endfor %}
            {% else %}
                <p>No products found.</p>
            {% endif %}
        </div>
    </div>

</body>
</html>
